<div class="home-container" [class.vertical]="scrollMode === 'vertical'" [class.horizontal]="scrollMode === 'horizontal'">
  <!-- Navigation Bar -->
  <nav class="nav-container">
    <app-nav-bar></app-nav-bar>
  </nav>

  <!-- Fixed Search Tools Section -->
  <div class="search-tools-container">
    <!-- Search Bar -->
    <div class="search-bar">
      <select [(ngModel)]="searchField">
        <option value="title">Title</option>
        <option value="description">Description</option>
        <option value="location">Location</option>
      </select>

      <input type="text" [(ngModel)]="searchTerm" placeholder="Search..." />

      <button (click)="onSearch()">Search</button>
      
      @if (filtersApplied) {
        <button (click)="clearFilters()" class="clear-btn">Clear Filters</button>
      }
    </div>

    <!-- Sort Bar -->
    <div class="sort-bar">
      <div class="sort-control">
        <label class="sort-label" for="sortBySelect">Sort by</label>
        <select id="sortBySelect" [(ngModel)]="sortOption" (change)="onSortChange()">
          <option value="title_asc">Title (A → Z)</option>
          <option value="title_desc">Title (Z → A)</option>
          <option value="price_asc">Price (Low → High)</option>
          <option value="price_desc">Price (High → Low)</option>
          <option value="rating_asc">Rating (Ascending)</option>
          <option value="rating_desc">Rating (Descending)</option>
        </select>
      </div>

      <div class="layout-toggle" role="group" aria-label="Layout">
        <button type="button" class="layout-btn" [class.active]="scrollMode === 'vertical'" (click)="setScrollMode('vertical')">
          Vertical
        </button>
        <button type="button" class="layout-btn" [class.active]="scrollMode === 'horizontal'" (click)="setScrollMode('horizontal')">
          Horizontal
        </button>
      </div>

      <button (click)="toggleMap()" class="map-preview-btn" [class.active]="mapExpanded" [title]="mapExpanded ? 'Hide map' : 'Show on map'">
        <div class="map-preview">
          <div class="map-preview-bg" aria-hidden="true"></div>
          <span class="map-preview-text">Show on map</span>
        </div>
      </button>
    </div>
  </div>

  <!-- Map Container -->
  @if (mapExpanded) {
    <div class="map-container">
      <div id="cottage-map" class="map-view"></div>
    </div>
  }

  <!-- Scrollable Cottages List -->
  <div class="cottages-scroll-container" 
       [class.map-visible]="mapExpanded"
       #cottagesScrollContainer>
    <div class="cottages-list">
      @for (cottage of Cottages; track cottage._id) {
        <div class="cottage-wrapper" 
             [attr.data-cottage-id]="cottage._id"
             (click)="selectCottage(cottage._id)"
             [class.selected]="selectedCottageId === cottage._id">
          <app-cottage_card 
            [cottage]="cottage" 
            [minimal]="mapExpanded"
            [selected]="selectedCottageId === cottage._id">
          </app-cottage_card>
        </div>
      }
    </div>
  </div>
</div>